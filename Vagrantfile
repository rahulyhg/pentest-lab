# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
  if Vagrant.has_plugin?('vagrant-hostmanager')
    config.hostmanager.enabled = true
    config.hostmanager.manage_host = true
    config.hostmanager.ignore_private_ip = false
  end
  config.vm.define 'kali-client' do |env|
    env.vm.box = 'waratek/kali-mini'
    #env.vm.hostname = 'kali-client'
    #env.vm.network 'private_network', ip: '10.10.10.10'
    env.vm.synced_folder 'bin', '/home/vagrant/bin', create: true, nfs: true
    env.vm.synced_folder 'scripts', '/home/vagrant/scripts', create: true, nfs: true
    env.vm.post_up_message = $message
  end
  config.vm.define 'dvwa-server' do |env|
    env.vm.box = 'hashicorp/precise32'
    #env.vm.box_url = 'https://atlas.hashicorp.com/hashicorp/boxes/precise32'
    env.vm.hostname = 'dmva-server'
    if Vagrant.has_plugin?('vagrant-hostmanager')
      env.hostmanager.aliases = %w(dvwa.server.io)
    end
    env.vm.network 'private_network', ip: '10.10.10.11'
    env.vm.provision 'shell', path: 'bin/provision.sh'
  end
  config.vm.provider 'virtualbox' do |vb|
    vb.gui = true
  end
  config.ssh.shell = "bash -c 'BASH_ENV=/etc/profile exec bash'"
end

$message = <<MSG
░█░█░█▀█░█░░░▀█▀
░█▀▄░█▀█░█░░░░█░
░▀░▀░▀░▀░▀▀▀░▀▀▀
VM Name ---> kali-client

░█▀▄░█░█░█░█░█▀█
░█░█░▀▄▀░█▄█░█▀█
░▀▀░░░▀░░▀░▀░▀░▀
VM Name ---> dvwa-server
IP --------> 10.10.10.11
Hostname --> dvwa.server.io
Username: admin
Password: password

MSG